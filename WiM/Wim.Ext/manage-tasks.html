<!DOCTYPE html>
<html>
<head>
    <script src="sdk/scripts/VSS.SDK.js"></script>

    <script src="scripts/settings.js"></script>
    <script src="scripts/menubar.js"></script>
    <script src="scripts/wit.js"></script>

    <style>
        .open-existing-work-item, .open-existing-work-item, #vss-bandik-extension, #vss-bandik-extension-config {
            margin: 20px;
        }

        .work-item-types {
            width: 200px;
            display: inline-block;
            margin-left: 5px;
            margin-right: 5px;
            vertical-align: bottom;
        }

        #existing-wit-id {
            border: 1px solid #DDD;
        }
    </style>
</head>
<body>
    <h3 id="header">Team</h3>
    <select id="teamSelect" >
        
    </select>


    <h3 id="header">Manage tasks</h3>

    <div class="tasks_input_fields_container_part" id="taskInputFields">
        <div>
            <!--<input type="text" name="tags">-->
            <button class="btn btn-sm btn-primary voeg_task_toe">Voeg toe</button>
        </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="scripts/manage-teams.js"></script>
    <script src="scripts/tasks.js"></script>

    <script>
        //var min = 12;
        //var max = 100;
        //var select = document.getElementById('teamSelect');

        $("#sort").change(function () {

            alert('Selected value: ' + $(this).val());
        });

        VSS.getService(VSS.ServiceIds.ExtensionData).then(function (dataService) {
            dataService.getDocuments(TeamSettingsCollectionName).then(function (docs) {

                var x = 0;

                // only teams setting. Not other settings
                var teamDocs = docs.filter(function (d) { return d.type === 'team'; });
                console.log("Initial load team settings : " + teamDocs.length + " out of " + docs.length + " settings.");

                teamDocs.forEach(
                    function (element) {

                        var inputId = "teamNaam" + x;
                        x++;

                        $('#teamSelect').append(
                            '<option class="teamSelectOption" id="' + inputId + '" value="' + element.text + '" onchange="TeamSelectedHandler(this)">' + element.text + '</option>'
                        );

                        
                    }
                );

                VSS.notifyLoadSucceeded();
            });

            VSS.notifyLoadSucceeded();
        });

        function TeamSelectedHandler(obj) {
            console.log("TeamSelectedHandler() clicked: " +obj);
        }

        var formData = "foo-manage-tasks-form-data-at-the-bottom";

        //// Register form object to be used across this extension
        console.log("VSS.Register() teams-form: " + formData);
        VSS.register("manage-tasks", formData);

    </script>



</body>
</html>